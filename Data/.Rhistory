setwd("/Users/apple/Desktop/Data")
# Load the data
hh <- read.csv("1_Household_Public.csv")
per <- read.csv("2_Person_Public.csv")
veh <- read.csv("3_Vehicle_Public.csv")
trip <- read.csv("4_Trip_Public.csv")
# load packages
library(dplyr)
library(ggplot2)
modechoice<-left_join(hh, trip, by = "HH_ID")
## clean the data-removing income missing values
modechoice <- modechoice %>%
filter(!INCOME %in% c(98, 99))
## Clean the data- removing missing MODE_AGG
modechoice <- modechoice %>%
filter(!is.na(MODE_AGG))
modechoice <- modechoice %>%
mutate(mode= case_when(MODE_AGG==1 ~ "Walk",
MODE_AGG==2 ~ "Bike",
MODE_AGG==3 ~ "Pravite Vehicle",
MODE_AGG==4 ~ "Pravite Transit",
MODE_AGG==5 ~ "Public Transit",
MODE_AGG==6 ~ "School Bus",
MODE_AGG==7 ~ "Other"))
modechoice$mode <- factor(modechoice$mode, levels = c("Walk",
"Bike",
"Pravite Vehicle",
"Pravite Transit",
"Public Transit",
"School Bus",
"Other"))
ggplot(modechoice, aes(x= mode, y=INCOME))+
boxplot()+
labs(title="Boxplot of Household Income by Mode Choice",
x="Mode Choice", y= "Household Income")+
theme_minimal()
ggplot(modechoice, aes(x=mode, y=INCOME))+
boxplot()+
labs(title="Boxplot of Household Income by Mode Choice",
x="Mode Choice", y= "Household Income")+
theme_minimal()
ggplot(modechoice, aes(x= mode, y= INCOME, fill = mode))+
geom_boxplot()+
labs(title="Boxplot of Household Income by Mode Choice",
x="Mode Choice", y= "Household Income")+
theme_minimal()
ggplot(modechoice, aes(x= mode, y= INCOME, fill = mode))+
geom_boxplot()+
labs(title="Boxplot of Household Income by Mode Choice",
x="Mode Choice", y= "Household Income")+
theme(legend.position = "none")
